{"version":3,"sources":["file:///Users/dima/Library/Caches/hugo_cache/modules/filecache/modules/pkg/mod/github.com/dmashchenko/blog-hugo-theme@v0.0.0-20251228151130-0c51d97e0dff/assets/js/lang.js"],"sourcesContent":["document.addEventListener('DOMContentLoaded', () =\u003e {\n    const langSwitchers = document.querySelectorAll('.lang-switcher a[data-lang]');\n    const localArticleSwitchers = document.querySelectorAll('.lang-switcher a[data-switch-type=\"article-local\"]');\n\n    // Constructs a language-aware URL, preserving the original's trailing slash.\n    const getLangAwareURL = (path, targetLang) =\u003e {\n        const langPrefixRegex = /^\\/(en|ua)(\\/|$)/;\n        let newPath = path.replace(langPrefixRegex, '/');\n\n        if (targetLang !== 'en') { // 'en' is the default language, no prefix needed.\n            newPath = `/${targetLang}${newPath}`;\n        }\n        \n        // Clean up any double slashes that might have been introduced.\n        newPath = newPath.replace(/\\/\\//g, '/');\n        \n        // Preserve the trailing slash from the original path.\n        const originalHasTrailingSlash = path.endsWith('/');\n        const newHasTrailingSlash = newPath.endsWith('/');\n        if (newPath !== '/') {\n            if (originalHasTrailingSlash \u0026\u0026 !newHasTrailingSlash) {\n                newPath += '/';\n            } else if (!originalHasTrailingSlash \u0026\u0026 newHasTrailingSlash) {\n                newPath = newPath.slice(0, -1);\n            }\n        }\n        \n        return newPath;\n    };\n\n    const handleLangChange = (event) =\u003e {\n        event.preventDefault();\n        const selectedLang = event.currentTarget.dataset.lang;\n        if (selectedLang) {\n            localStorage.setItem('userLang', selectedLang);\n            \n            const newPath = getLangAwareURL(window.location.pathname, selectedLang);\n\n            window.location.href = newPath + window.location.search + window.location.hash;\n        }\n    };\n\n    langSwitchers.forEach(switcher =\u003e switcher.addEventListener('click', handleLangChange));\n\n    localArticleSwitchers.forEach(switcher =\u003e {\n        switcher.addEventListener('click', (event) =\u003e {\n            event.preventDefault();\n            // Flag that this is a temporary switch for one page, not a new preference.\n            sessionStorage.setItem('isLocalArticleSwitch', 'true');\n            window.location.href = event.currentTarget.dataset.targetUrl;\n        });\n    });\n\n    // --- On page load ---\n\n    const savedLang = localStorage.getItem('userLang');\n    const isLocalArticleSwitch = sessionStorage.getItem('isLocalArticleSwitch');\n\n    if (isLocalArticleSwitch) {\n        // Clear the flag for the next navigation.\n        sessionStorage.removeItem('isLocalArticleSwitch');\n    } else if (savedLang \u0026\u0026 savedLang !== document.documentElement.lang) {\n        // If there's a saved language preference, and it differs from the current page's language,\n        // redirect on relevant pages (home, articles).\n        const currentPath = window.location.pathname;\n        const isHomepage = currentPath === '/' || /^\\/(en|ua)\\/$/.test(currentPath);\n        const isArticlePage = /^\\/(en|ua)?\\/articles(\\/|$)/.test(currentPath);\n\n        if (isHomepage || isArticlePage) {\n            const newPath = getLangAwareURL(currentPath, savedLang);\n            if (newPath !== currentPath) {\n                window.location.replace(newPath + window.location.search + window.location.hash);\n            }\n        }\n    }\n\n    // Update main menu links to reflect the user's stored language preference.\n    if (savedLang) {\n        const menuLinksToUpdate = [\n            document.querySelector('.home-icon-container a'),\n            document.querySelector('.menu-items-container ul li a[href*=\"/articles\"]')\n        ];\n\n        menuLinksToUpdate.forEach(link =\u003e {\n            if (link) {\n                link.href = getLangAwareURL(link.getAttribute('href'), savedLang);\n            }\n        });\n    }\n});"],"mappings":";;AAAA,WAAS,iBAAiB,oBAAoB,MAAM;AAChD,UAAM,gBAAgB,SAAS,iBAAiB,6BAA6B;AAC7E,UAAM,wBAAwB,SAAS,iBAAiB,oDAAoD;AAG5G,UAAM,kBAAkB,CAAC,MAAM,eAAe;AAC1C,YAAM,kBAAkB;AACxB,UAAI,UAAU,KAAK,QAAQ,iBAAiB,GAAG;AAE/C,UAAI,eAAe,MAAM;AACrB,kBAAU,IAAI,UAAU,GAAG,OAAO;AAAA,MACtC;AAGA,gBAAU,QAAQ,QAAQ,SAAS,GAAG;AAGtC,YAAM,2BAA2B,KAAK,SAAS,GAAG;AAClD,YAAM,sBAAsB,QAAQ,SAAS,GAAG;AAChD,UAAI,YAAY,KAAK;AACjB,YAAI,4BAA4B,CAAC,qBAAqB;AAClD,qBAAW;AAAA,QACf,WAAW,CAAC,4BAA4B,qBAAqB;AACzD,oBAAU,QAAQ,MAAM,GAAG,EAAE;AAAA,QACjC;AAAA,MACJ;AAEA,aAAO;AAAA,IACX;AAEA,UAAM,mBAAmB,CAAC,UAAU;AAChC,YAAM,eAAe;AACrB,YAAM,eAAe,MAAM,cAAc,QAAQ;AACjD,UAAI,cAAc;AACd,qBAAa,QAAQ,YAAY,YAAY;AAE7C,cAAM,UAAU,gBAAgB,OAAO,SAAS,UAAU,YAAY;AAEtE,eAAO,SAAS,OAAO,UAAU,OAAO,SAAS,SAAS,OAAO,SAAS;AAAA,MAC9E;AAAA,IACJ;AAEA,kBAAc,QAAQ,cAAY,SAAS,iBAAiB,SAAS,gBAAgB,CAAC;AAEtF,0BAAsB,QAAQ,cAAY;AACtC,eAAS,iBAAiB,SAAS,CAAC,UAAU;AAC1C,cAAM,eAAe;AAErB,uBAAe,QAAQ,wBAAwB,MAAM;AACrD,eAAO,SAAS,OAAO,MAAM,cAAc,QAAQ;AAAA,MACvD,CAAC;AAAA,IACL,CAAC;AAID,UAAM,YAAY,aAAa,QAAQ,UAAU;AACjD,UAAM,uBAAuB,eAAe,QAAQ,sBAAsB;AAE1E,QAAI,sBAAsB;AAEtB,qBAAe,WAAW,sBAAsB;AAAA,IACpD,WAAW,aAAa,cAAc,SAAS,gBAAgB,MAAM;AAGjE,YAAM,cAAc,OAAO,SAAS;AACpC,YAAM,aAAa,gBAAgB,OAAO,gBAAgB,KAAK,WAAW;AAC1E,YAAM,gBAAgB,8BAA8B,KAAK,WAAW;AAEpE,UAAI,cAAc,eAAe;AAC7B,cAAM,UAAU,gBAAgB,aAAa,SAAS;AACtD,YAAI,YAAY,aAAa;AACzB,iBAAO,SAAS,QAAQ,UAAU,OAAO,SAAS,SAAS,OAAO,SAAS,IAAI;AAAA,QACnF;AAAA,MACJ;AAAA,IACJ;AAGA,QAAI,WAAW;AACX,YAAM,oBAAoB;AAAA,QACtB,SAAS,cAAc,wBAAwB;AAAA,QAC/C,SAAS,cAAc,kDAAkD;AAAA,MAC7E;AAEA,wBAAkB,QAAQ,UAAQ;AAC9B,YAAI,MAAM;AACN,eAAK,OAAO,gBAAgB,KAAK,aAAa,MAAM,GAAG,SAAS;AAAA,QACpE;AAAA,MACJ,CAAC;AAAA,IACL;AAAA,EACJ,CAAC;","names":[]}